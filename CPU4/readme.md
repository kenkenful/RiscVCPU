## CPU4
フェッチステージとデコードステージの間にパイプラインレジスタを挿入し、
パイプラインレジスタには、フェッチした命令とpc、pc_plusを渡しています。。フェッチした命令は、デコードステージでデコードされ、pcは実行ステージでジャンプアドレスを計算するのに必要です。</br>
①のクロックの立ち上がりで、ALUにてjumpアドレスが計算され、組み合わせ回路で構成されたpcレジスタの手前までjumpアドレス信号が伝わります。それと同時に、青矢印で示すjumpアドレスの次の命令は、パイプラインレジスタの手前まで伝搬しますが（①）、jumpが成立した場合は、実行してはいけないので、②のクロックの立ち上がりでパイプラインレジスタをフラッシュし、この命令を消去する必要があります。そのため、１サイクル分何も実行しない期間が発生することになります。</br>

```
  a0:	02010413          	addi	s0,sp,32
  a4:	00a00513          	li	a0,10
  a8:	058000ef          	jal	100 <fib>
    ...

  100:	fe010113          	addi	sp,sp,-32
```


また、命令メモリからのフェッチをパイプラインのクロックに同期化することで、命令メモリをBRAM化しています。

![CPU](https://github.com/user-attachments/assets/b5f10e19-d368-4e0a-a573-a0f907467b11)
